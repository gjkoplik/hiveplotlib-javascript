import*as e from"https://cdn.jsdelivr.net/npm/d3@7/+esm";function b(o){let t={...o};return"lw"in t&&!("linewidth"in t)&&(t.linewidth=t.lw,delete t.lw),"ls"in t&&!("linestyle"in t)&&(t.linestyle=t.ls,delete t.ls),t}function A(o){let t={...o};return"facecolor"in t?(t._fill=t.facecolor,delete t.facecolor):"color"in t?(t._fill=t.color,delete t.color):"c"in t&&(t._fill=t.c,delete t.c),"size"in t&&!("s"in t)&&(t.s=t.size,delete t.size),"edgecolors"in t&&!("edgecolor"in t)&&(t.edgecolor=t.edgecolors,delete t.edgecolors),t}function G(o){return{"-":null,solid:null,"--":"5,5",dashed:"5,5",":":"2,2",dotted:"2,2","-.":"5,2,2,2",dashdot:"5,2,2,2"}[o]??null}function w(o){return{viridis:e.interpolateViridis,plasma:e.interpolatePlasma,inferno:e.interpolateInferno,magma:e.interpolateMagma,cividis:e.interpolateCividis,warm:e.interpolateWarm,cool:e.interpolateCool,turbo:e.interpolateTurbo,Blues:e.interpolateBlues,Greens:e.interpolateGreens,Greys:e.interpolateGreys,Oranges:e.interpolateOranges,Purples:e.interpolatePurples,Reds:e.interpolateReds,BuGn:e.interpolateBuGn,BuPu:e.interpolateBuPu,GnBu:e.interpolateGnBu,OrRd:e.interpolateOrRd,PuBu:e.interpolatePuBu,PuBuGn:e.interpolatePuBuGn,PuRd:e.interpolatePuRd,RdPu:e.interpolateRdPu,YlGn:e.interpolateYlGn,YlGnBu:e.interpolateYlGnBu,YlOrBr:e.interpolateYlOrBr,YlOrRd:e.interpolateYlOrRd,BrBG:e.interpolateBrBG,PRGn:e.interpolatePRGn,PiYG:e.interpolatePiYG,PuOr:e.interpolatePuOr,RdBu:e.interpolateRdBu,RdGy:e.interpolateRdGy,RdYlBu:e.interpolateRdYlBu,RdYlGn:e.interpolateRdYlGn,Spectral:e.interpolateSpectral,coolwarm:e.interpolateRdBu,rainbow:e.interpolateRainbow}[o]??e.interpolateViridis}function R(o){return Math.sqrt(o/Math.PI)}function P(o=0,t=0,p=0,g=0,c=900,i=600,s="body"){var r={},f;return r.top=function(n){return arguments.length?(o=n,r):o},r.left=function(n){return arguments.length?(p=n,r):p},r.right=function(n){return arguments.length?(g=n,r):g},r.bottom=function(n){return arguments.length?(t=n,r):t},r.width=function(n){return arguments.length?(c=n,r):c},r.height=function(n){return arguments.length?(i=n,r):i},r.element=function(n){return arguments.length?(s=n,r):s},r.innerWidth=function(){return r.width()-r.left()-r.right()},r.innerHeight=function(){return r.height()-r.top()-r.bottom()},r.svg=function(){return f},r.render=function(){f=e.select(s).append("svg").attr("width",r.innerWidth()+r.left()+r.right()).attr("height",r.innerHeight()+r.top()+r.bottom()).append("g").attr("transform","translate("+p+", "+o+")")},r}function _(o=[-5,5],t=[-5,5],p=0,g=0,c=0,i=0,s=450,r=450,f="body"){var n=P().top(p).bottom(g).left(c).right(i).width(s).height(r).element(f);n.render();let u=e.scaleLinear().range([r-g,p]).domain(t),m=e.scaleLinear().range([c,s-i]).domain(o);return{svgInfo:n,xExtent:o,yExtent:t,x:m,y:u}}function z(o,t,p,g){let c=Object.keys(o.axes);for(let i=0;i<c.length;i++){let s=o.axes[c[i]],r=s.start,f=s.end,n=[p(r[0]),g(r[1])],u=[p(f[0]),g(f[1])],m=e.line()([n,u]);t.append("path").attr("d",m).attr("stroke","black").attr("stroke-width",1.5).attr("stroke-opacity",.5).attr("class","axis")}}function S(o,t,p,g){let c=Object.keys(o.axes);for(let i=0;i<c.length;i++){let s=c[i],r=o.axes[s].nodes.x,f=o.axes[s].nodes.y,n={};o.node_viz_kwargs&&o.node_viz_kwargs[s]&&(n=A(o.node_viz_kwargs[s]));let u=null;if(Array.isArray(n._fill)&&n._fill.length>0&&typeof n._fill[0]=="number"){let l=w(n.cmap),a=[n.vmin??e.min(n._fill),n.vmax??e.max(n._fill)];u=e.scaleSequential(l).domain(a)}let m=e.zip(r,f);t.selectAll(null).data(m).enter().append("circle").attr("cx",l=>p(l[0])).attr("cy",l=>g(l[1])).attr("r",(l,a)=>{let d=Array.isArray(n.s)?n.s[a]:n.s??20;return R(d)}).attr("fill",(l,a)=>u?u(n._fill[a]):Array.isArray(n._fill)?n._fill[a]:n._fill||"black").attr("fill-opacity",(l,a)=>Array.isArray(n.alpha)?n.alpha[a]:n.alpha??.8).attr("stroke",(l,a)=>n.edgecolor?Array.isArray(n.edgecolor)?n.edgecolor[a]:n.edgecolor:"none").attr("class","node")}}function Y(o,t,p,g){if(!o.edges)return;let c=Object.keys(o.edges);for(let i=0;i<c.length;i++){let s=Object.keys(o.edges[c[i]]);for(let r=0;r<s.length;r++){let f=Object.keys(o.edges[c[i]][s[r]]);for(let n=0;n<f.length;n++){let u=o.edges[c[i]][s[r]][f[n]];if(!u.ids||u.ids.length===0)continue;let m=u.ids.length,l=b(u.edge_kwargs||{}),a=null;if(l.array){let d=w(l.cmap),B=l.clim||e.extent(l.array);a=e.scaleSequential(d).domain(B)}for(let d=0;d<m;d++){let B=u.curves[d],v=e.line().x(k=>p(k[0])).y(k=>g(k[1])),y=t.append("path").datum(B).attr("d",k=>v(k)).attr("fill","none").attr("class","edge");a&&l.array?y.attr("stroke",a(l.array[d])):Array.isArray(l.color)?y.attr("stroke",l.color[d]):y.attr("stroke",l.color||"black");let h=Array.isArray(l.alpha)?l.alpha[d]:l.alpha??.5;y.attr("stroke-opacity",h);let x=Array.isArray(l.linewidth)?l.linewidth[d]:l.linewidth??1.5;if(y.attr("stroke-width",x),l.linestyle){let k=G(Array.isArray(l.linestyle)?l.linestyle[d]:l.linestyle);k&&y.attr("stroke-dasharray",k)}}}}}}function O(o,t,p,g,c={}){let{labelsBuffer:i=1.1,fontSize:s=14,horizontalAngleSpan:r=60,verticalAngleSpan:f=60}=c,n=Object.keys(o.axes);for(let u=0;u<n.length;u++){let m=o.axes[n[u]],l=m.long_name||n[u],a=m.angle;if(a===void 0)continue;let d=m.start,B=m.end,v=d[0]+i*(B[0]-d[0]),y=d[1]+i*(B[1]-d[1]),h;a>=360-r||a<=r?h="start":a>=180-r&&a<=180+r?h="end":h="middle";let x;a>=90-f&&a<=90+f?x="auto":a>=270-f&&a<=270+f?x="hanging":x="middle",t.append("text").attr("x",p(v)).attr("y",g(y)).attr("text-anchor",h).attr("dominant-baseline",x).attr("font-size",s).attr("class","axis-label").text(l)}}function I(o,t=[-5,5],p=[-5,5],g=0,c=0,i=0,s=0,r=450,f=450,n="body",u={}){let{showLabels:m=!0,labelsBuffer:l=1.1,fontSize:a=14}=u;var d=_(t,p,g,c,i,s,r,f,n);let B=v=>{let y=d.svgInfo.svg(),h=d.x,x=d.y;Y(v,y,h,x),z(v,y,h,x),S(v,y,h,x),m&&O(v,y,h,x,{labelsBuffer:l,fontSize:a})};return typeof o=="string"?e.json(o).then(B):B(o),d.svgInfo.svg()}export{w as cmapToD3Interpolator,I as default,_ as initializeSVG,G as linestyleToDasharray,P as marcon,b as normalizeEdgeKwargs,A as normalizeNodeKwargs,z as plotAxes,Y as plotEdges,O as plotLabels,S as plotNodes,R as scatterSizeToRadius};
