import*as e from"https://cdn.jsdelivr.net/npm/d3@7/+esm";function b(l){let t={...l};return"lw"in t&&!("linewidth"in t)&&(t.linewidth=t.lw,delete t.lw),"ls"in t&&!("linestyle"in t)&&(t.linestyle=t.ls,delete t.ls),t}function A(l){let t={...l};return"facecolor"in t?(t._fill=t.facecolor,delete t.facecolor,delete t.color,delete t.c):"color"in t?(t._fill=t.color,delete t.color,delete t.c):"c"in t&&(t._fill=t.c,delete t.c),"size"in t&&!("s"in t)&&(t.s=t.size,delete t.size),"edgecolors"in t&&!("edgecolor"in t)&&(t.edgecolor=t.edgecolors,delete t.edgecolors),t}function G(l){return{"-":null,solid:null,"--":"5,5",dashed:"5,5",":":"2,2",dotted:"2,2","-.":"5,2,2,2",dashdot:"5,2,2,2"}[l]??null}function k(l){return{viridis:e.interpolateViridis,plasma:e.interpolatePlasma,inferno:e.interpolateInferno,magma:e.interpolateMagma,cividis:e.interpolateCividis,warm:e.interpolateWarm,cool:e.interpolateCool,turbo:e.interpolateTurbo,Blues:e.interpolateBlues,Greens:e.interpolateGreens,Greys:e.interpolateGreys,Oranges:e.interpolateOranges,Purples:e.interpolatePurples,Reds:e.interpolateReds,BuGn:e.interpolateBuGn,BuPu:e.interpolateBuPu,GnBu:e.interpolateGnBu,OrRd:e.interpolateOrRd,PuBu:e.interpolatePuBu,PuBuGn:e.interpolatePuBuGn,PuRd:e.interpolatePuRd,RdPu:e.interpolateRdPu,YlGn:e.interpolateYlGn,YlGnBu:e.interpolateYlGnBu,YlOrBr:e.interpolateYlOrBr,YlOrRd:e.interpolateYlOrRd,BrBG:e.interpolateBrBG,PRGn:e.interpolatePRGn,PiYG:e.interpolatePiYG,PuOr:e.interpolatePuOr,RdBu:e.interpolateRdBu,RdGy:e.interpolateRdGy,RdYlBu:e.interpolateRdYlBu,RdYlGn:e.interpolateRdYlGn,Spectral:e.interpolateSpectral,coolwarm:e.interpolateRdBu,rainbow:e.interpolateRainbow}[l]??e.interpolateViridis}function R(l){return Math.sqrt(l/Math.PI)}function P(l=0,t=0,p=0,g=0,c=900,i=600,s="body"){var r={},f;return r.top=function(n){return arguments.length?(l=n,r):l},r.left=function(n){return arguments.length?(p=n,r):p},r.right=function(n){return arguments.length?(g=n,r):g},r.bottom=function(n){return arguments.length?(t=n,r):t},r.width=function(n){return arguments.length?(c=n,r):c},r.height=function(n){return arguments.length?(i=n,r):i},r.element=function(n){return arguments.length?(s=n,r):s},r.innerWidth=function(){return r.width()-r.left()-r.right()},r.innerHeight=function(){return r.height()-r.top()-r.bottom()},r.svg=function(){return f},r.render=function(){f=e.select(s).append("svg").attr("width",r.innerWidth()+r.left()+r.right()).attr("height",r.innerHeight()+r.top()+r.bottom()).append("g").attr("transform","translate("+p+", "+l+")")},r}function _(l=[-5,5],t=[-5,5],p=0,g=0,c=0,i=0,s=450,r=450,f="body"){var n=P().top(p).bottom(g).left(c).right(i).width(s).height(r).element(f);n.render();let u=e.scaleLinear().range([r-g,p]).domain(t),m=e.scaleLinear().range([c,s-i]).domain(l);return{svgInfo:n,xExtent:l,yExtent:t,x:m,y:u}}function z(l,t,p,g){let c=Object.keys(l.axes);for(let i=0;i<c.length;i++){let s=l.axes[c[i]],r=s.start,f=s.end,n=[p(r[0]),g(r[1])],u=[p(f[0]),g(f[1])],m=e.line()([n,u]);t.append("path").attr("d",m).attr("stroke","black").attr("stroke-width",1.5).attr("stroke-opacity",.5).attr("class","axis")}}function S(l,t,p,g){let c=Object.keys(l.axes);for(let i=0;i<c.length;i++){let s=c[i],r=l.axes[s].nodes.x,f=l.axes[s].nodes.y,n={};l.node_viz_kwargs&&l.node_viz_kwargs[s]&&(n=A(l.node_viz_kwargs[s]));let u=null;if(Array.isArray(n._fill)&&n._fill.length>0&&typeof n._fill[0]=="number"){let o=k(n.cmap),a=[n.vmin??e.min(n._fill),n.vmax??e.max(n._fill)];u=e.scaleSequential(o).domain(a)}let m=e.zip(r,f);t.selectAll(null).data(m).enter().append("circle").attr("cx",o=>p(o[0])).attr("cy",o=>g(o[1])).attr("r",(o,a)=>{let d=Array.isArray(n.s)?n.s[a]:n.s??20;return R(d)}).attr("fill",(o,a)=>u?u(n._fill[a]):Array.isArray(n._fill)?n._fill[a]:n._fill||"black").attr("fill-opacity",(o,a)=>Array.isArray(n.alpha)?n.alpha[a]:n.alpha??.8).attr("stroke",(o,a)=>n.edgecolor?Array.isArray(n.edgecolor)?n.edgecolor[a]:n.edgecolor:"none").attr("class","node")}}function Y(l,t,p,g){if(!l.edges)return;let c=Object.keys(l.edges);for(let i=0;i<c.length;i++){let s=Object.keys(l.edges[c[i]]);for(let r=0;r<s.length;r++){let f=Object.keys(l.edges[c[i]][s[r]]);for(let n=0;n<f.length;n++){let u=l.edges[c[i]][s[r]][f[n]];if(!u.ids||u.ids.length===0)continue;let m=u.ids.length,o=b(u.edge_kwargs||{}),a=null;if(o.array){let d=k(o.cmap),v=o.clim||e.extent(o.array);a=e.scaleSequential(d).domain(v)}for(let d=0;d<m;d++){let v=u.curves[d],B=e.line().x(w=>p(w[0])).y(w=>g(w[1])),y=t.append("path").datum(v).attr("d",w=>B(w)).attr("fill","none").attr("class","edge");a&&o.array?y.attr("stroke",a(o.array[d])):Array.isArray(o.color)?y.attr("stroke",o.color[d]):y.attr("stroke",o.color||"black");let h=Array.isArray(o.alpha)?o.alpha[d]:o.alpha??.5;y.attr("stroke-opacity",h);let x=Array.isArray(o.linewidth)?o.linewidth[d]:o.linewidth??1.5;if(y.attr("stroke-width",x),o.linestyle){let w=G(Array.isArray(o.linestyle)?o.linestyle[d]:o.linestyle);w&&y.attr("stroke-dasharray",w)}}}}}}function O(l,t,p,g,c={}){let{labelsBuffer:i=1.1,fontSize:s=14,horizontalAngleSpan:r=60,verticalAngleSpan:f=60}=c,n=Object.keys(l.axes);for(let u=0;u<n.length;u++){let m=l.axes[n[u]],o=m.long_name||n[u],a=m.angle;if(a===void 0)continue;let d=m.start,v=m.end,B=d[0]+i*(v[0]-d[0]),y=d[1]+i*(v[1]-d[1]),h;a>=360-r||a<=r?h="start":a>=180-r&&a<=180+r?h="end":h="middle";let x;a>=90-f&&a<=90+f?x="auto":a>=270-f&&a<=270+f?x="hanging":x="middle",t.append("text").attr("x",p(B)).attr("y",g(y)).attr("text-anchor",h).attr("dominant-baseline",x).attr("font-size",s).attr("class","axis-label").text(o)}}async function I(l,t=[-5,5],p=[-5,5],g=0,c=0,i=0,s=0,r=450,f=450,n="body",u={}){let{showLabels:m=!0,labelsBuffer:o=1.1,fontSize:a=14}=u;var d=_(t,p,g,c,i,s,r,f,n);let v=B=>{let y=d.svgInfo.svg(),h=d.x,x=d.y;Y(B,y,h,x),z(B,y,h,x),S(B,y,h,x),m&&O(B,y,h,x,{labelsBuffer:o,fontSize:a})};if(typeof l=="string"){let B=await e.json(l);v(B)}else v(l);return d.svgInfo.svg()}export{k as cmapToD3Interpolator,I as default,_ as initializeSVG,G as linestyleToDasharray,P as marcon,b as normalizeEdgeKwargs,A as normalizeNodeKwargs,z as plotAxes,Y as plotEdges,O as plotLabels,S as plotNodes,R as scatterSizeToRadius};
